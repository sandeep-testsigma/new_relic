import{j as n,q as u,d as l,S as y,C as f,r as w,t as S,u as O,v as b,x as E}from"./index-CmgIUs00.js";import{A as g,i as R}from"./aggregate-base-bsioHYSn.js";import{i as A}from"./iframe-PalxAwQ_.js";const r={REACT:"React",NEXTJS:"NextJS",VUE:"Vue",NUXTJS:"NuxtJS",ANGULAR:"Angular",ANGULARUNIVERSAL:"AngularUniversal",SVELTE:"Svelte",SVELTEKIT:"SvelteKit",PREACT:"Preact",PREACTSSR:"PreactSSR",ANGULARJS:"AngularJS",BACKBONE:"Backbone",EMBER:"Ember",METEOR:"Meteor",ZEPTO:"Zepto",JQUERY:"Jquery",MOOTOOLS:"MooTools",QWIK:"Qwik",ELECTRON:"Electron"};function M(){if(!n)return[];const e=[];try{m()&&(e.push(r.REACT),T()&&e.push(r.NEXTJS)),P()&&(e.push(r.VUE),C()&&e.push(r.NUXTJS)),v()&&(e.push(r.ANGULAR),N()&&e.push(r.ANGULARUNIVERSAL)),L()&&(e.push(r.SVELTE),j()&&e.push(r.SVELTEKIT)),U()&&(e.push(r.PREACT),k()&&e.push(r.PREACTSSR)),G()&&e.push(r.ANGULARJS),Object.prototype.hasOwnProperty.call(window,"Backbone")&&e.push(r.BACKBONE),Object.prototype.hasOwnProperty.call(window,"Ember")&&e.push(r.EMBER),Object.prototype.hasOwnProperty.call(window,"Meteor")&&e.push(r.METEOR),Object.prototype.hasOwnProperty.call(window,"Zepto")&&e.push(r.ZEPTO),Object.prototype.hasOwnProperty.call(window,"jQuery")&&e.push(r.JQUERY),Object.prototype.hasOwnProperty.call(window,"MooTools")&&e.push(r.MOOTOOLS),Object.prototype.hasOwnProperty.call(window,"qwikevents")&&e.push(r.QWIK),I()&&e.push(r.ELECTRON)}catch{}return e}function m(){try{return Object.prototype.hasOwnProperty.call(window,"React")||Object.prototype.hasOwnProperty.call(window,"ReactDOM")||Object.prototype.hasOwnProperty.call(window,"ReactRedux")||document.querySelector("[data-reactroot], [data-reactid]")||(()=>{const e=document.querySelectorAll("body > div");for(let t=0;t<e.length;t++)if(Object.prototype.hasOwnProperty.call(e[t],"_reactRootContainer"))return!0})()}catch{return!1}}function T(){try{return Object.prototype.hasOwnProperty.call(window,"next")&&Object.prototype.hasOwnProperty.call(window.next,"version")}catch{return!1}}function P(){try{return Object.prototype.hasOwnProperty.call(window,"Vue")}catch{return!1}}function C(){try{return Object.prototype.hasOwnProperty.call(window,"$nuxt")&&Object.prototype.hasOwnProperty.call(window.$nuxt,"nuxt")}catch{return!1}}function v(){try{return Object.prototype.hasOwnProperty.call(window,"ng")||document.querySelector("[ng-version]")}catch{return!1}}function N(){try{return document.querySelector("[ng-server-context]")}catch{return!1}}function L(){try{return Object.prototype.hasOwnProperty.call(window,"__svelte")}catch{return!1}}function j(){try{return!!Object.keys(window).find(e=>e.startsWith("__sveltekit"))}catch{return!1}}function U(){try{return Object.prototype.hasOwnProperty.call(window,"preact")}catch{return!1}}function k(){try{return document.querySelector('script[type="__PREACT_CLI_DATA__"]')}catch{return!1}}function G(){try{return Object.prototype.hasOwnProperty.call(window,"angular")||document.querySelector(".ng-binding, [ng-app], [data-ng-app], [ng-controller], [data-ng-controller], [ng-repeat], [data-ng-repeat]")||document.querySelector('script[src*="angular.js"], script[src*="angular.min.js"]')}catch{return!1}}function I(){try{return typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}catch{return!1}}class F extends g{static featureName=u;constructor(t){super(t,u),this.harvestOpts.aggregatorTypes=["cm","sm"],this.agentNonce=n&&document.currentScript?.nonce,this.waitForFlags(["err"]).then(([i])=>{i?(this.singleChecks(),this.eachSessionChecks(),this.drain()):(this.blocked=!0,this.deregisterDrain())}),l(y,this.storeSupportabilityMetrics.bind(this),this.featureName,this.ee),l(f,this.storeEventMetrics.bind(this),this.featureName,this.ee)}preHarvestChecks(t){return this.drained&&t.isFinalHarvest}storeSupportabilityMetrics(t,i){if(this.blocked)return;const o=w,s={name:t};this.events.addMetric(o,t,s,i)}storeEventMetrics(t,i){if(this.blocked)return;const o=S,s={name:t};this.events.add([o,t,s,i])}singleChecks(){const{distMethod:t,loaderType:i}=this.agentRef.runtime,{proxy:o,privacy:s}=this.agentRef.init;if(i&&this.storeSupportabilityMetrics("Generic/LoaderType/".concat(i,"/Detected")),t&&this.storeSupportabilityMetrics("Generic/DistMethod/".concat(t,"/Detected")),n?(this.storeSupportabilityMetrics("Generic/Runtime/Browser/Detected"),this.agentNonce&&this.agentNonce!==""&&this.storeSupportabilityMetrics("Generic/Runtime/Nonce/Detected"),O(()=>{M().forEach(c=>{this.storeSupportabilityMetrics("Framework/"+c+"/Detected")})}),s.cookies_enabled||this.storeSupportabilityMetrics("Config/SessionTracking/Disabled")):b?this.storeSupportabilityMetrics("Generic/Runtime/Worker/Detected"):this.storeSupportabilityMetrics("Generic/Runtime/Unknown/Detected"),R()&&this.storeSupportabilityMetrics("Generic/FileProtocol/Detected"),this.obfuscator.obfuscateConfigRules.length>0&&this.storeSupportabilityMetrics("Generic/Obfuscate/Detected"),o.assets&&this.storeSupportabilityMetrics("Config/AssetsUrl/Changed"),o.beacon&&this.storeSupportabilityMetrics("Config/BeaconUrl/Changed"),n&&window.MutationObserver){A(window)&&this.storeSupportabilityMetrics("Generic/Runtime/IFrame/Detected");const c=window.document.querySelectorAll("video").length;c&&this.storeSupportabilityMetrics("Generic/VideoElement/Added",c);const a=window.document.querySelectorAll("iframe").length;a&&this.storeSupportabilityMetrics("Generic/IFrame/Added",a),new MutationObserver(d=>{d.forEach(h=>{h.addedNodes.forEach(p=>{p instanceof HTMLVideoElement&&this.storeSupportabilityMetrics("Generic/VideoElement/Added",1),p instanceof HTMLIFrameElement&&this.storeSupportabilityMetrics("Generic/IFrame/Added",1)})})}).observe(window.document.body,{childList:!0,subtree:!0})}navigator.webdriver&&this.storeSupportabilityMetrics("Generic/WebDriver/Detected")}eachSessionChecks(){n&&E("pageshow",t=>{t?.persisted&&this.storeSupportabilityMetrics("Generic/BFCache/PageRestored")})}}export{F as Aggregate};
//# sourceMappingURL=index-BK-oxElE.js.map
