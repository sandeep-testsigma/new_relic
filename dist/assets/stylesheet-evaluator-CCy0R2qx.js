import{j as r,H as l}from"./index-Czkn9eiI.js";class n{#t=new WeakSet;#e=[];invalidStylesheetsDetected=!1;failedToFix=0;evaluate(){let t=0;if(this.#e=[],r){for(let e=0;e<Object.keys(document.styleSheets).length;e++)if(!this.#t.has(document.styleSheets[e])&&document.styleSheets[e]instanceof CSSStyleSheet){this.#t.add(document.styleSheets[e]);try{const s=document.styleSheets[e].cssRules}catch{if(!document.styleSheets[e].href)return;t++,this.#e.push(document.styleSheets[e])}}}return t&&(this.invalidStylesheetsDetected=!0),t}async fix(){await Promise.all(this.#e.map(e=>this.#s(e))),this.#e=[];const t=this.failedToFix;return this.failedToFix=0,t}async#s(t){if(t?.href)try{const e=await l().o.FETCH.bind(window)(t.href);if(!e.ok){this.failedToFix++;return}const s=await e.text();try{const i=new CSSStyleSheet;await i.replace(s),Object.defineProperty(t,"cssRules",{get(){return i.cssRules}}),Object.defineProperty(t,"rules",{get(){return i.rules}})}catch{Object.defineProperty(t,"cssText",{get(){return s}}),this.failedToFix++}}catch{this.failedToFix++}}}const a=new n;export{a as s};
//# sourceMappingURL=stylesheet-evaluator-CCy0R2qx.js.map
